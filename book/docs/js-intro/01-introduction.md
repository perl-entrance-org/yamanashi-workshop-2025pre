# JavaScript入門

ここではまずTypeScript(TS)の元になっている言語であるJavaScript(JS)について学んでいきましょう。


# 実行環境について

## ブラウザ上で動かす場合

このテキストブックでは「実行」ボタンを押すと実行できるような機能があります。
ソースコードをクリックすると中身の編集も出来るので、ちょっとした動作を試すには便利です。

<!-- js-console -->
```js
console.log("こんにちは????");
```

テキストブック以外でブラウザ上でJavaScriptを実行したい場合はいくつかのサービスやブラウザの機能を使うことができます。

ブラウザの機能を使う場合は右クリックで「検証」を押したあとに出てくる開発者ツールの中から「コンソール」を選択してみましょう。
コンソールタブからはJavaScriptのREPL(Read-Eval-Print Loop)と呼ばれる、ユーザーが入力したソースコードを即時に評価するプログラムを使うことができます。

例えば次のソースコードをブラウザのREPLに貼り付けてみましょう。

```js
console.log("これを貼り付けてみてください");
```

その他にはWebサービスとしてJavaScriptを実行できる環境が有ります。

- [TypeScriptプレイグラウンド](https://www.typescriptlang.org/ja/play/)
    - メインはTypeScriptの実行環境
    - エラーや補完が極めてわかりやすいので初学者から幅広く使える
- [Wandbox](https://wandbox.org/)
    - JS/TS以外のも様々な言語が使える
- [JSFiddle](https://jsfiddle.net/)
    - 海外製。HTMLなども含めて検証できる


## Node.jsで動かす場合

# console.log

<!-- js-console -->
```js
console.log(1 + 1);
console.log("ここの中身を変えてみてください");
```


# 文と式

JavaScript/TypeScriptに限らず、大半のプログラミング言語は**文**(statement)と**式**(expression)という構成要素で成り立っています。

## 式 (expression)

式とは評価するとなんらかの値になり、変数に代入することができるもののことを言います。

例えば `1 + 1`は、評価(実行)すると`2`という値になります。
この`1 + 1`という計算や結果の`2`という数値そのものも式となります。

<!-- js-console -->
```js
// 1という式の評価値を表示
console.log(1 + 1);

// 2という式の評価値を表示
console.log(2);

// 1 + 1 という式の評価値をsumに代入
const sum = 1 + 1;
```

## 文(statement)

対して文は、処理する1ステップ、あるプログラムの流れのことを言います。

文を上から下に処理することでプログラムが実行されます。

```
処理する文1;
処理する文2;
処理する文3;
```

文としては代入文や、`if`文などが存在します。

<!-- js-console -->
```js
const hoge = 1 + 1;
const isTrue = true;

if (isTrue) {
  console.log("True!!");
}
```

JavaScript/TypeScriptにおける文は末尾に`;`をいれる必要があります。文章の区切りですね。

# 四則演算

JavaScript/TypeScriptでは様々な計算をすることができます。



# 変数

計算結果を一度しか使わないのであれば、電卓のように変数は使用する必要が有りません。
```js
500 / 10 ; ==> 50
```


そうでない場合、例えば「あるゲームの上位100人対してプレゼントを配布する」という処理を考えます。
このような場合にはまず上位100人をメモしておき、一人ずつ処理する流れをとる、、、というように、上位100人の一覧を参照しやすいようにメモとして残しておいたほうが便利でしょう。
このメモのことをプログラムでは 変数(`variable`) と呼び、何かしらの名前をつけて計算結果を保存しておくことができます。



## 変数宣言

JavaScriptで変数を使う前には「こういった変数を使います」というのをプログラム上に示す必要があります。
これを変数宣言と言います。

JavaScriptでは変数の宣言に`const`または`let`というキーワードをを使います。
(実はもう1つ`var`での宣言も可能なのですが、`var`は意図しない挙動を招きがちであるので現代では使用が非推奨となっています)


### `let`


`=`は数学的な「右辺と左辺が等しい」ではなく「値の代入(割当、紐づけ)」を意味します。

次のフローで動作します

1. 右辺を評価(実行, `evaluate`)
1. その結果を左辺の変数に保存する


したがって、次のようなプログラムがあった場合は最終的に`hitpoint`は10になります。

<!-- js-console -->
```js
// 最初に hitpoint に 100を代入
let hitpoint = 100;

// hitpoint に (100 - 90)の結果を再代入
hitpoint = hitpoint - 90;

console.log(hitpoint);
```


### `const`

`const`を使用すると再代入不可な変数とその初期値を宣言できます。

```js
const 変数名 = 初期値;
```

次のように再代入をしようとするとエラーが発生します。

<!-- js-console -->
```js
const airline = 'jal'
airline = 'ana';
```

#### constの細部

`const`はあくまで変数の再代入を禁止する宣言であり、定数の宣言とは異なります。
したがってオブジェクトや配列を宣言した場合は破壊的に値を書き換えることが可能です。

<!-- js-console -->
```js
const cinephoto = ['satuki', 'ann'];
cinephoto.push('sakurako'); // 配列に破壊的に値を追加可能
console.log(cinephoto); // 'satuki', 'ann', 'sakurako'
```

オブジェクトの場合はフィールドに対しての再代入が可能です。

<!-- js-console -->
```js
const japan = { capital: '東京' };
japan.capital = '山梨';  // フィールドには再代入が可能
console.log(`日本の首都は${japan.capital}`); 
```

なおあくまでこれはJavaScriptの話であり、TypeScriptでは型を工夫することでこれらの破壊的な代入を防ぐことが可能です。

## 変数名のルール

変数名にはいくつかの特徴があります


1 大文字小文字の区別がある

<!-- js-console -->
```js
const BAR = '123';
const bar = 456;

console.log(`BAR is ${BAR}`);
console.log(`bar is ${bar}`);
```

2 Unicodeの文字と`$`, `_`, 数字を使える。ただし数字では始められない

<!-- js-console -->
```js
const ねこ = 'cat';
console.log(`ねこ is ${ねこ}`);

const 山梨の熊 = 'ツキノワグマ';
console.log(`山梨の熊 is ${山梨の熊}`);

const _bar = 'foo';
console.log(`_bar is ${_bar}`);

const Cicada_3301 = 'puzzle';
console.log(`Cicada_3301 is ${Cicada_3301}`);

const $ = 'ドル';
console.log(`$ is ${$}`);
```

ということで日本語を変数名にすることも可能です。
また変数名の大文字小文字の制限も特にありません。大文字で変数にすることも可能です。

とはいえ実際は慣例的に次のようなことが多いです。

- 定数はすべて大文字
- 型名は大文字から始める
- 変数は小文字で始める
- `$`はjQueryなどのDOMを操作する際のオブジェクトにつける
- 日本語の変数としては極力使わない
    - ただしテストコードなどで関数名として使うケースもあるにはある

### 練習問題


## constとletの使い分け

さて変数宣言には`const`と`let`があることを学びました。
なんとなく`let`の方が再代入もできるので便利そうな気がしますが、実際はどうやって使い分けると良いのでしょうか。

基本的な方針としては次のものを推奨します。

- 基本的には`const`を使う
- どうしようも無い場合のみ`let`を使う
    - (慣れてきたら) `let`を使わなくても良いようにプログラムを工夫する

`const`を使うと再代入ができません。これを踏まえると例えば文字列や数値や最初に宣言した値が最後まで使われることになります。

`let`を使ってしまうと途中でなんらかの処理が挟まると数値が代わってしまう可能性があります。

つまり`let`で宣言された変数を扱う場合、プログラムをよく読んで今何の値が入っているかを注意深く追う必要があります。対して`const`の場合は宣言部分だけ読めばいいので、プログラムを読む上でだいぶ楽になります。

また実際問題として再代入を必要とする処理は、JavaScript/TypeScriptのよい機能を使うとほとんどが`const`での宣言で書けるようになっています。計算した結果を保存する際も、再代入ではなく別名で保存すれば良いわけです。
さらに一見すると`let`を使わざるを得なさそうな処理も、JavaScriptを習得していくにつれて便利な様々な機能を使っていくと、意外と`const`でイケる、となっていきます。

また、実はこの後やるTypeScriptを使う上では特に`const`を使って値が決まっているコト、がとても便利にプログラミングできる体験につながっていきます。

そのため基本的には`const`を使ってJavaScriptはプログラミングするようにしていきましょう。
